<apex:page controller="GW_CTRL_ETGratitude" title="Gratitude Machine">

<style>

	.cssActionColumn a {
		color: #015BA7;
		text-decoration: none;
	}	

	.cssHelpText {
		padding: 10px;		
		margin-top: 10px;
		margin-bottom: 10px;
	}

	
</style>

    <apex:sectionHeader title="Gratitude Machine" />        
    	<apex:form >
    		<apex:pageBlock title="Show Some Love!" mode="edit">
    			<apex:pageBlockButtons >
					<apex:commandButton action="{!doneWithRecipients}" value="Done" rendered="{!hasRecipients}" />	    			
				</apex:pageBlockButtons>
    			<apex:pageBlockSection id="panelFilter" columns="1" rendered="{!NOT(hasRecipients)}" >
			   		<div class="cssHelpText" >
		    			Let's find some people that you should gratify!<br/><br/>
		    			<b><i>New Climbers</i></b> are people who are most recently in their level.<br/>  
		    			<b><i>Old Steadies</i></b> are people who are longest in their level, but have done some action in the last year.
		    		</div>
		    		
					<apex:pageBlockSection columns="1">
						<apex:pageBlockSectionItem >
							<apex:outputLabel value="How Many Thank You's" />
							<apex:inputText value="{!numRecipients}" size="4" />
						</apex:pageBlockSectionItem>
						<apex:pageBlockSectionItem >
							<apex:outputLabel value="Who to Include" />
					        <apex:selectRadio layout="pageDirection" value="{!strWhoToInclude}" >
					            <apex:selectOption itemValue="New" itemLabel="New Climbers"/>
					            <apex:selectOption itemValue="Old" itemLabel="Old Steadies"/>
					        </apex:selectRadio> 
	   					</apex:pageBlockSectionItem>
	   					<apex:pageBlockSectionItem >
							<apex:outputLabel value="Limit to Campaign (optional)" />
							<apex:inputField value="{!cmFilter.CampaignId}" required="false" />
	   					</apex:pageBlockSectionItem>
	   					<apex:pageBlockSectionItem >
	   						<apex:outputLabel />
	   						<apex:commandButton value="Go" action="{!NewGratitudeRun}" />
	   					</apex:pageBlockSectionItem>
					</apex:pageBlockSection>
				</apex:pageBlockSection>

    			<apex:pageBlockSection Title="Recent Gratitude Runs" columns="1" rendered="{!NOT(hasRecipients)}" >
					<apex:pageBlockTable value="{!listCmpGratitude}" var="cmp" >
						<apex:column styleClass="cssActionColumn" >		 				
							<apex:facet name="header">Action</apex:facet>
				                <apex:commandLink value="Go" />
						</apex:column>	
						<apex:column value="{!cmp.Name}" />		 				
						<apex:column value="{!cmp.Type}" />		 				
						<apex:column value="{!cmp.StartDate}" />		 				
						<apex:column value="{!cmp.NumberOfContacts}" />		 				
						<apex:column value="{!cmp.NumberOfResponses}" />
					</apex:pageBlockTable>		 				
    			</apex:pageBlockSection>
			
	    		<apex:pageBlockSection id="panelRecipient" rendered="{!hasRecipients}" >
					<apex:pageBlockTable value="{!listRecipient}" var="rec" >
						<apex:column styleClass="cssActionColumn" >		 				
							<apex:facet name="header">Action</apex:facet>
			                	<nobr>
				                <apex:commandLink value="Thanked" />&nbsp;|&nbsp;
				                <apex:commandLink value="Left Msg" />&nbsp;|&nbsp;
				                <apex:commandLink value="Remove" />&nbsp;
				                </nobr>
						</apex:column>	
						
						<apex:column value="{!rec.cm.Status}" />
						
						<apex:repeat value="{!$ObjectType.Contact.FieldSets.Gratitude_Machine}" var="f" >
							<apex:column value="{!rec.con[f]}" />					
						</apex:repeat>
												
					</apex:pageBlockTable>	    		
	    		</apex:pageBlockSection>
    		</apex:pageBlock>
    	
    	</apex:form>

</apex:page>